function ajaxRequest(e,t=null,a={}){let n=$.ajax({type:a.method||"POST",url:e,dataType:a.dataType||"json",data:t,cache:!1,async:void 0===a.async||a.async});return n.done((function(e){a.callback&&a.callback(e)})),n.fail((function(e){a.failCallback&&a.failCallback(e)})),n.responseJSON}function replace_template(e,t){return e.replace(/{(\w*)}/g,(function(e,a){return t.hasOwnProperty(a)?t[a]:""}))}function process_each(e,t,a,n={}){let i=0,o=e.length;!function s(){let l=t.call(e[i++]);i<o?setTimeout(s,a):n.completeCallback&&n.completeCallback(l)}()}function random_string(e){let t="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",n=a.length;for(let i=0;i<e;i++)t+=a.charAt(Math.floor(Math.random()*n));return t}let grecaptchaWidget,grecaptchaWidgetResolver;$(document).ready((function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$(document).ajaxError((function(e,t,a,n){401===t.status&&(window.location="/"),419===t.status&&(window.location=location.toString())}))}));let CreatePromise=function(e){let t,a=!1,n=[];return e((function(e){a=!0,t=e,n.forEach((function(e){e()}))})),{then:function(e){a?e(t):n.push((function(){e(t)}))}}};function recaptchaLoadCallback(){grecaptchaWidget=grecaptcha.render(document.getElementById("recaptcha-render"),{sitekey:recaptchaSiteKey,callback:function(e){grecaptchaWidgetResolver(e)},size:"invisible"})}function loadRecapchaAndSubmit(e){if("undefined"==typeof grecaptcha)return;CreatePromise((function(e){grecaptchaWidgetResolver=e})).then((function(t){e(t)})),grecaptcha.reset(grecaptchaWidget),grecaptcha.execute(grecaptchaWidget).catch((function(e){console.err(e)}))}function recapchaRenderTokenToForm(e){return"undefined"==typeof grecaptcha||(loadRecapchaAndSubmit((function(t){let a=document.createElement("input");a.name="g-recaptcha-response",a.value=t,a.type="hidden",e.appendChild(a),HTMLFormElement.prototype.submit.call(e)})),!1)}function toastr_message(e,t,a=null){1==t?toastr.success(e,a||juzaweb.lang.successfully+" !!"):toastr.error(e,a||juzaweb.lang.error+" !!")}function confirm_message(e,t,a="",n="warning"){Swal.fire({title:a,text:e,type:n,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:juzaweb.lang.yes+"!",cancelButtonText:juzaweb.lang.cancel+"!"}).then((e=>{t(e.value)}))}function get_message_response(e){if(e.data)return!!e.data.message&&{status:e.status,message:e.data.message};if(e.responseJSON){if(e.responseJSON.errors){let t="";return $.each(e.responseJSON.errors,(function(e,a){return t=a[0],!1})),{status:!1,message:t}}if(e.responseJSON.message)return{status:!1,message:e.responseJSON.message}}return e.message?{status:!1,message:e.message.message}:void 0}function show_message(e,t=!1){let a=get_message_response(e);if(!a)return;let n=`<div class="alert alert-${a.status?"success":"danger"} jw-message">\n        <button type="button" class="close" data-dismiss="alert" aria-label="${juzaweb.lang.close}">\n            <span aria-hidden="true">&times;</span>\n        </button>\n\n        ${a.status?'<i class="fa fa-check"></i>':'<i class="fa fa-times"></i>'} ${a.message}\n    </div>`;t?$("#jquery-message").append(n):$("#jquery-message").html(n)}function show_notify(e){let t=get_message_response(e);toastr_message(t.message,t.status)}function htmlspecialchars(e){return(e=String(e)).replace("&","&amp;").replace('"',"&quot;").replace("'","&#039;").replace("<","&lt;").replace(">","&gt;")}function toggle_global_loading(e,t=300){e?$("#admin-overlay").fadeIn(300):setTimeout((function(){$("#admin-overlay").fadeOut(300)}),t)}toastr.options.timeOut=3e3,$(document).ready((function(){$("body").on("click",".custom-seo",(function(){let e=$(this),t=$("input[name=title]").val(),a=tinyMCE.activeEditor.getContent();if($("#meta_title").val()&&$("#meta_description").val())return e.hide("slow"),$(".box-custom-seo").show("slow"),!1;$.ajax({type:"POST",url:juzaweb.adminUrl+"/ajax/seo-content",dataType:"json",data:{title:t,description:a}}).done((function(t){return!1===t.status?(show_message(t),!1):($("#meta_title").val()||$("#meta_title").val(t.title),$("#meta_description").val()||$("#meta_description").val(t.description),$("#meta_title").val()||$(".review-title").text(t.title),$("#meta_description").val()||$(".review-description").text(t.description),e.hide("slow"),$(".box-custom-seo").show("slow"),!1)})).fail((function(e){return show_message(e),!1}))})),$("input[name=title], textarea[name=content]").on("change",(function(){let e=$("input[name=title]").val(),t=tinyMCE.activeEditor.getContent();$.ajax({type:"POST",url:juzaweb.adminUrl+"/ajax/seo-content",dataType:"json",data:{title:e,description:t}}).done((function(e){return!1===e.status?(show_message(e),!1):($("#meta_title").val()||$(".review-title").text(e.title),$("#meta_description").val()||$(".review-description").text(e.description),!1)})).fail((function(e){return show_message(e),!1}))})),$("form").on("change","input[name=slug]",(function(){let e=$(this).val();$(".review-url span").text(e)})),$("#meta_title, #meta_description, #meta_url").on("change",(function(){let e=$("#meta_title").val(),t=$("#meta_description").val();$.ajax({type:"POST",url:juzaweb.adminUrl+"/ajax/seo-content",dataType:"json",data:{title:e,description:t}}).done((function(e){return!1===e.status?(show_message(e.message),!1):($(".review-title").text(e.title),$(".review-description").text(e.description),!1)})).fail((function(e){return show_message(e),!1}))}))}));let juzawebFileManager=function(e,t){let a=e.type||"image",n=e.disk||null,i=e.prefix,o=e.multichoose||!1;"/"!==i[0]&&(i="/"+i);let s=void 0!==window.screenLeft?window.screenLeft:window.screenX,l=e.width?e.width:800,d=e.height?e.height:500,r=void 0!==window.screenTop?window.screenTop:window.screenY,c=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,u=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,m=c/window.screen.availWidth,h=(c-l)/2/m+s,p=(u-d)/2/m+r;window.open(i+"?type="+a+(o?"&multichoose=1":"")+(n?"&disk="+n:""),"File Manager","scrollbars=yes, width="+l/m+", height="+d/m+", top="+p+", left="+h),window.SetUrl=t};function jwUpdateProcess(e,t=null,a=0,n="primary"){t&&$(e+" .process-text").append(`<li class="text-${n}">${t}</li>`),a&&$(e+" .progress-bar").attr("aria-valuenow",a).text(a+"%").css("width",a+"%")}function jwCMSUpdate(e,t,a=null,n={},i=null,o=null){let s=juzaweb.adminUrl+"/update/"+e+"/__STEP__";a&&jwUpdateProcess(a,juzaweb.lang.update_process["step"+t].before),ajaxRequest(s.replace("__STEP__",t),n,{method:"POST",callback:function(s){if(0==s.status)return o&&o(s),a&&jwUpdateProcess(a,s.data.message,0,"danger"),!1;s.data.next_url?(a&&jwUpdateProcess(a,null,17*t),jwCMSUpdate(e,t+1,a,n,i,o)):(i&&i(s),a&&jwUpdateProcess(a,juzaweb.lang.update_process.done,100,"success"))},failCallback:function(e){let n=e.message||"Server Error";o&&o(e),a&&jwUpdateProcess(a,n,15*t,"danger")}})}function recursiveUpdate(e,t,a=0,n=null,i=null){let o={};o="theme"==e?{theme:t[a]}:{plugin:t[a]},jwCMSUpdate(e,1,"#"+e+"-"+t[a].replace("/","_")+"-update-process",o,(function(o){t[a+1]?recursiveUpdate(e,t,a+1,n,i):n&&n(o)}),(function(o){i&&i(o),t[a+1]&&recursiveUpdate(e,t,a+1,n,i)}))}function initSelect2(e="body"){$(e+" .select2").select2({allowClear:!0,dropdownAutoWidth:!$(this).data("width"),width:$(this).data("width")||"100%",placeholder:function(e){return{id:null,text:e.placeholder}}}),$(e+" .select2-default").select2({width:$(this).data("width")||"100%",dropdownAutoWidth:!$(this).data("width")}),$(e+" .load-taxonomies").select2({allowClear:!0,dropdownAutoWidth:!$(this).data("width"),width:$(this).data("width")||"100%",placeholder:function(e){return{id:null,text:e.placeholder}},ajax:{method:"GET",url:juzaweb.adminUrl+"/load-data/loadTaxonomies",dataType:"json",data:function(e){let t=$(this).data("post-type"),a=$(this).data("taxonomy"),n=$(this).data("explodes");return n&&(n=$("."+n).map((function(){return $(this).val()})).get()),{search:$.trim(e.term),page:e.page,explodes:n,post_type:t,taxonomy:a}}}}),$(e+" .load-users").select2({allowClear:!0,dropdownAutoWidth:!$(this).data("width"),width:$(this).data("width")||"100%",placeholder:function(e){return{id:null,text:e.placeholder}},ajax:{method:"GET",url:"/"+juzaweb.adminPrefix+"/load-data/loadUsers",dataType:"json",data:function(e){let t=$(this).data("explodes")?$(this).data("explodes"):null;return t&&(t=$("."+t).map((function(){return $(this).val()})).get()),{search:$.trim(e.term),page:e.page,explodes:t}}}}),$(e+" .load-menu").select2({allowClear:!0,dropdownAutoWidth:!$(this).data("width"),width:$(this).data("width")||"100%",placeholder:function(e){return{id:null,text:e.placeholder}},ajax:{method:"GET",url:"/"+juzaweb.adminPrefix+"/load-data/loadMenu",dataType:"json",data:function(e){let t=$(this).data("explodes")?$(this).data("explodes"):null;return t&&(t=$("."+t).map((function(){return $(this).val()})).get()),{search:$.trim(e.term),page:e.page,explodes:t}}}}),$(e+" .load-pages").select2({allowClear:!0,dropdownAutoWidth:!$(this).data("width"),width:$(this).data("width")||"100%",placeholder:function(e){return{id:null,text:e.placeholder}},ajax:{method:"GET",url:"/"+juzaweb.adminPrefix+"/load-data/loadPages",dataType:"json",data:function(e){return{search:$.trim(e.term),page:e.page}}}}),$(e+" .load-posts").select2({allowClear:!0,dropdownAutoWidth:!$(this).data("width"),width:$(this).data("width")||"100%",placeholder:function(e){return{id:null,text:e.placeholder}},ajax:{method:"GET",url:"/"+juzaweb.adminPrefix+"/load-data/loadPosts",dataType:"json",data:function(e){let t=$(this).data("type")?$(this).data("type"):null;return{search:$.trim(e.term),page:e.page,type:t}}}}),$(e+" .load-locales").select2({allowClear:!0,dropdownAutoWidth:!$(this).data("width"),width:$(this).data("width")||"100%",placeholder:function(e){return{id:null,text:e.placeholder}},ajax:{method:"GET",url:"/"+juzaweb.adminPrefix+"/load-data/loadLocales",dataType:"json",data:function(e){let t=$(this).data("type")?$(this).data("type"):null,a=$(this).data("explodes")?$(this).data("explodes"):null;return{search:$.trim(e.term),page:e.page,type:t,explodes:a}}}}),$(e+" .load-select2").select2({allowClear:!0,dropdownAutoWidth:!$(this).data("width"),width:$(this).data("width")||"100%",placeholder:function(e){return{id:null,text:e.placeholder}},ajax:{method:"GET",url:$(this).data("url")||"",dataType:"json",data:function(e){return{search:$.trim(e.term),page:e.page}}}}),$(e+" .load-resources").select2({allowClear:!0,dropdownAutoWidth:!$(this).data("width"),width:$(this).data("width")||"100%",placeholder:function(e){return{id:null,text:e.placeholder}},ajax:{method:"GET",url:juzaweb.adminUrl+"/load-data/loadResource",dataType:"json",data:function(e){let t=$(this).data("type"),a=$(this).data("explodes");return a&&(a=$("."+a).map((function(){return $(this).val()})).get()),{search:$.trim(e.term),page:e.page,explodes:a,type:t}}}}),$(e+" .load-subscription-objects").select2({allowClear:!0,dropdownAutoWidth:!$(this).data("width"),width:$(this).data("width")||"100%",placeholder:function(e){return{id:null,text:e.placeholder}},ajax:{method:"GET",url:juzaweb.adminUrl+"/load-data/loadSubscriptionObjects",dataType:"json",data:function(e){let t=$(this).data("module");return{search:$.trim(e.term),page:e.page,module:t}}}})}$.fn.filemanager=function(e,t){let a=this,n=juzaweb.adminPrefix+"/file-manager";this.on("click",(function(t){juzawebFileManager({type:e,prefix:n},(function(e){let t=e[0];if(a.data("input")){$("#"+a.data("input")).val(t.path)}if(a.data("preview")){$("#"+a.data("preview")).html('<img src="'+t.url+'" alt="'+t.name+'">')}if(a.data("name")){$("#"+a.data("name")).html(t.name)}}))}))},$((function(){const e=$("body");e.on("click",".file-manager",(function(){let e=$(this).data("type")||"image",t=$(this).data("input"),a=$(this).data("preview"),n=$(this).data("name"),i=juzaweb.adminPrefix+"/file-manager",o=$(this).data("disk");juzawebFileManager({type:e,prefix:i,disk:o},(function(e){let i=e[0];if(t){$("#"+t).val(i.path)}if(a){$("#"+a).html('<img src="'+i.url+'" alt="">')}if(n){$("#"+n).html(i.name)}}))})),e.on("click",".form-image",(function(){let e=$(this),t=e.find(".input-path"),a=e.find(".dropify-render"),n=e.find(".dropify-filename-inner"),i=juzaweb.adminPrefix+"/file-manager";juzawebFileManager({type:"image",prefix:i},(function(i){let o=i[0];t.val(o.path),a.html('<img src="'+o.url+'" alt="">'),n.html(o.name),e.addClass("previewing"),e.find(".image-hidden").show()}))})),e.on("click",".form-image .image-clear",(function(e){e.stopPropagation();let t=$(this).closest(".form-image"),a=t.find(".input-path"),n=t.find(".dropify-render"),i=t.find(".dropify-filename-inner");a.val(""),n.html(""),i.html(""),t.removeClass("previewing"),t.find(".image-hidden").hide()})),e.on("click",".add-image-images",(function(){let e=juzaweb.adminPrefix+"/file-manager",t=$(this).closest(".form-images"),a=t.find(".input-name").val();juzawebFileManager({type:"image",prefix:e,multichoose:!0},(function(e){let n=document.getElementById("form-images-template").innerHTML,i="";$.each(e,(function(e,t){i+=replace_template(n,{name:a,url:t.url,path:t.path})})),t.find(".images-list .image-item:last").before(i)}))})),e.on("click",".form-images .remove-image-item",(function(){$(this).closest(".image-item").remove()}))})),$(document).ready((function(){$(".jw-widget-builder").nestable({noDragClass:"dd-nodrag",maxDepth:1}),$("#widget-container").on("click",".dropdown-action",(function(){let e=$(this).closest(".widget-block").find(".sidebar-blocks");e.is(":hidden")?e.show():e.hide()})),$("#widget-container").on("submit",".form-add-widget",(function(){let e=$(this).serialize(),t=$(this).find("button[type=submit]"),a=t.find("i").attr("class");return t.find("i").attr("class","fa fa-spinner fa-spin"),t.prop("disabled",!0),ajaxRequest(juzaweb.adminUrl+"/widgets/get-item",e,{method:"GET",callback:function(e){let n=e.items||[];$.each(n,(function(e,t){$("#sidebar-"+e+" .jw-widget-builder .dd-empty").remove(),$("#sidebar-"+e+" .dd-list").append(t.html)})),$.each(n,(function(e,t){initSelect2("#dd-item-"+t.key)})),t.find("i").attr("class",a),t.prop("disabled",!1)},failCallback:function(){show_message(response),t.find("i").attr("class",a),t.prop("disabled",!1)}}),!1})),$("#widget-container").on("click",".widget-sidebar-item",(function(){let e=$(this),t=e.find("input").is(":checked"),a=e.closest(".form-add-widget"),n=a.find("button[type=submit]");t?(e.find("span").html(""),e.find("input").prop("checked",!1)):(e.find("span").html('<i class="fa fa-check"></i>'),e.find("input").prop("checked",!0)),a.find(".widget-sidebar-item input:checked").length>0?n.prop("disabled",!1):n.prop("disabled",!0)})),$("#widget-container").on("click",".show-edit-form",(function(){let e=$(this).closest(".sidebar-item").find(".card-body");e.is(":hidden")?e.show():e.hide()})),$("#widget-container").on("click",".show-item-form",(function(){let e=$(this).closest(".dd-item").find(".form-item-edit");e.is(":hidden")?e.show():e.hide()})),$("#widget-container").on("click",".delete-item-form",(function(){$(this).closest(".dd-item").remove()}))})),$(document).ready((function(){const e=$("#media-container");e.on("click",".show-form-upload",(function(){let e=$(".media-upload-form");e.is(":hidden")?e.show("slow"):e.hide("slow")})),e.on("click",".media-file-item",(function(){let e=document.getElementById("media-detail-template").innerHTML,t=JSON.parse($(this).find(".item-info").val());t.name=htmlspecialchars(t.name),e=replace_template(e,t),$("#preview-file").html(e)})),$("#preview-file").on("click",".delete-file",(function(){let e=$(this).data("id"),t=$(this).data("is_file"),a=$(this).data("name");confirm_message(juzaweb.lang.remove_question.replace(":name",1==t?" file "+a:" folder "+a),(function(a){if(!a)return!1;toggle_global_loading(!0),ajaxRequest(juzaweb.adminUrl+"/media/"+e,{is_file:t},{method:"DELETE",callback:function(e){toggle_global_loading(!1),show_notify(e),setTimeout((function(){window.location=""}),500)},failCallback:function(e){toggle_global_loading(!1),show_notify(e)}})}))}))})),$(document).ready((function(){var e=function(e){var t=e.length?e:$(e.target);window.JSON?$("#items-output").val(window.JSON.stringify(t.nestable("serialize"))):alert("JSON browser support required for this application.")};$("#jw-menu-builder").nestable({noDragClass:"dd-nodrag"}).on("change",e),e($("#jw-menu-builder")),$("#menu-container").on("submit",".form-menu-block",(function(t){if(t.isDefaultPrevented())return!1;t.preventDefault();var a=$(this),n=new FormData(a[0]),i=a.find("button[type=submit]"),o=i.find("i").attr("class");i.find("i").attr("class","fa fa-spinner fa-spin"),i.prop("disabled",!0),$.ajax({type:a.attr("method"),url:a.attr("action"),dataType:"json",data:n,cache:!1,contentType:!1,processData:!1}).done((function(t){if(i.find("i").attr("class",o),i.prop("disabled",!1),!1===t.status)return show_message(t),!1;let n=t.data.items;return n.length>0&&($("#jw-menu-builder .dd-empty").remove(),$.each(n,(function(e,t){$("#jw-menu-builder .dd-list:first").append(t)}))),e($("#jw-menu-builder")),a.find(".reset-after-add").val(""),!1})).fail((function(e){return i.find("i").attr("class",o),i.prop("disabled",!1),show_message(e),!1}))})),$("#menu-container").on("click",".btn-add-menu",(function(){let e=$(".form-add-menu");e.is(":hidden")?e.show("slow"):e.hide("slow")})),$("#menu-container").on("change",".form-select-menu .load-menu",(function(){let e=$(this).val();e&&(window.location=juzaweb.adminUrl+"/menus/"+e)})),$("#menu-container").on("click",".card-menu-show",(function(){let e=$(this).closest(".card-menu-items").find(".card-body");e.is(":hidden")?($(".card-menu-items").find(".card-body").slideUp("slow"),$(".card-menu-items").find(".card-header").removeClass("bg-light"),$(this).closest(".card-menu-items").find(".card-header").addClass("bg-light"),e.slideDown("slow")):(e.slideUp("slow"),$(this).closest(".card-menu-items").find(".card-header").removeClass("bg-light"))})),$("#menu-container").on("click",".show-menu-edit",(function(e){let t=$(this).closest(".dd-item").find(".form-item-edit").first();t.is(":hidden")?t.slideDown("slow"):t.slideUp("slow")})),$("#menu-container").on("click",".delete-menu",(function(e){let t=$(this).data("id");confirm_message(juzaweb.lang.remove_question.replace(":name",juzaweb.lang.menu),(function(e){e&&ajaxRequest(juzaweb.adminUrl+"/menus/"+t,{},{method:"DELETE",callback:function(e){show_message(e),window.location=juzaweb.adminUrl+"/menus"}})}))})),$("#menu-container").on("change",".menu-data",(function(){let t=$(this).data("name"),a=$(this).val();$(this).closest("li").data(t,a),e($("#jw-menu-builder")),$(this).hasClass("change-label")&&$(this).closest("li").find(".dd-handle span:first").text(a)})),$("#menu-container").on("click",".delete-menu-item",(function(){$(this).closest("li").remove(),e($("#jw-menu-builder"))})),$("#menu-container").on("click",".close-menu-item",(function(){let e=$(this).closest(".dd-item").find(".form-item-edit").first();e.is(":hidden")?e.slideDown("slow"):e.slideUp("slow")})),$("#menu-container").on("change",".select-all-checkbox",(function(){let e=$(this).data("select"),t=$(this).is(":checked");$(this).closest(".tab-pane").find("."+e).prop("checked",t)})),$("#menu-container").on("keyup",".menu-box-post-type-search",(function(){let e=$(this).val(),t=$(this).data("key"),a=$(this).data("post_type"),n=$(this).closest(".tab-pane").find(".box-tab-search-result");return n.html(""),e.length<=0||ajaxRequest(juzaweb.adminUrl+"/load-data/loadPostType",{search:e,per_page:5,post_type:a},{method:"GET",callback:function(e){let a="";return $.each(e.results,(function(e,n){a+=`<div class="form-check mt-1">\n                        <label class="form-check-label">\n                            <input class="form-check-input select-all-search-${t}" type="checkbox" name="items[]" value="${n.id}">\n                            ${n.text}\n                        </label>\n                    </div>`})),n.html(a),!1}}),!1})),$("#menu-container").on("keyup",".menu-box-taxonomy-search",(function(){let e=$(this).val(),t=$(this).data("key"),a=$(this).data("taxonomy"),n=$(this).closest(".tab-pane").find(".box-tab-search-result");return n.html(""),e.length<=0||ajaxRequest(juzaweb.adminUrl+"/load-data/loadTaxonomies",{search:e,per_page:5,taxonomy:a},{method:"GET",callback:function(e){let a="";return $.each(e.results,(function(e,n){a+=`<div class="form-check mt-1">\n                        <label class="form-check-label">\n                            <input class="form-check-input select-all-search-${t}" type="checkbox" name="items[]" value="${n.id}">\n                            ${n.text}\n                        </label>\n                    </div>`})),n.html(a),!1}}),!1}))})),$(document).ready((function(){let e=$("body");e.on("click",".install-plugin",(function(){let e=$(this).data("plugin"),t=$(this),a=t.html();t.prop("disabled",!0),t.html('<i class="fa fa-spinner fa-spin"></i> '+juzaweb.lang.please_wait),jwCMSUpdate("plugin",1,null,{plugin:e},(function(e){t.html(juzaweb.lang.activate),t.removeClass("install-plugin"),t.addClass("active-plugin"),t.prop("disabled",!1)}),(function(e){show_message(e),t.prop("disabled",!1),t.html(a)}))})),e.on("click",".active-plugin",(function(){let e=$(this).data("plugin"),t=$(this);t.prop("disabled",!0),ajaxRequest(juzaweb.adminUrl+"/plugins/bulk-actions",{ids:[e],action:"activate"},{method:"POST",callback:function(e){show_message(e),t.html(`<i class="fa fa-check"></i> ${juzaweb.lang.activated}`),t.removeClass("active-plugin"),t.prop("disabled",!0)},failCallback:function(e){show_message(e),t.prop("disabled",!1)}})}))})),$(document).ready((function(){let e=$("body");e.on("click",".update-theme",(function(){let e=$(this).data("theme"),t=$(this),a=t.html();t.prop("disabled",!0),t.html('<i class="fa fa-spinner fa-spin"></i> '+juzaweb.lang.please_wait),jwCMSUpdate("theme",1,null,{theme:e},(function(e){t.remove(),show_message(e)}),(function(e){t.prop("disabled",!1),t.html(a),show_message(e)}))})),e.on("click",".install-theme",(function(){let e=$(this).data("theme"),t=$(this),a=t.html();t.prop("disabled",!0),t.html('<i class="fa fa-spinner fa-spin"></i> '+juzaweb.lang.please_wait),jwCMSUpdate("theme",1,null,{theme:e},(function(e){t.html(juzaweb.lang.activate),t.removeClass("install-theme"),t.addClass("active-theme"),t.prop("disabled",!1)}),(function(e){show_message(e),t.prop("disabled",!1),t.html(a)}))})),e.on("click",".active-theme",(function(){let e=$(this).data("theme"),t=$(this);t.prop("disabled",!0),ajaxRequest(juzaweb.adminUrl+"/themes/activate",{theme:e},{method:"POST",callback:function(e){show_message(e),t.html(`<i class="fa fa-check"></i> ${juzaweb.lang.activated}`),t.removeClass("active-theme"),t.prop("disabled",!0)},failCallback:function(e){show_message(e),t.prop("disabled",!1)}})})),e.on("click",".delete-theme",(function(){let e=$(this).data("theme"),t=$(this),a=t.html();confirm_message(juzaweb.lang.delete_theme_confirm,(function(n){if(!n)return!1;t.html('<i class="fa fa-spinner fa-spin"></i> '+juzaweb.lang.please_wait),ajaxRequest(juzaweb.adminUrl+"/themes/bulk-actions",{ids:[e],action:"delete"},{method:"POST",callback:function(e){show_message(e),1==e.status&&t.closest(".theme-list-item").remove()},failCallback:function(e){show_message(e),t.html(a)}})}))})),e.on("click",".buy-theme",(function(){let e=$(this),t=e.data("theme"),a=e.html();e.prop("disabled",!0),e.html('<i class="fa fa-spinner fa-spin"></i>'),ajaxRequest(juzaweb.adminUrl+"/module/theme/buy-modal",{module:t},{method:"GET",callback:function(t){$("#show-modal").empty().html(t.data.html),$("#show-modal .modal").modal(),e.html(a),e.prop("disabled",!1)},failCallback:function(t){show_message(t),e.html(a),e.prop("disabled",!1)}})})),e.on("submit","#form-activation-code, #form-select-key",(function(e){if(e.isDefaultPrevented())return!1;e.preventDefault();let t=$(this),a=t.find("button[type=submit]"),n=t.find("input[name=module]").val(),i=t.find("[name=key]").val(),o=a.html();return!!i&&(a.prop("disabled",!0),a.html('<i class="fa fa-spinner fa-spin"></i> '+juzaweb.lang.please_wait),ajaxRequest(juzaweb.adminUrl+"/module/theme/activation-code",{module:n,key:i},{method:"POST",callback:function(e){return!0!==e.status?(show_message(e),a.html(o),a.prop("disabled",!1),!1):(t.find("input[name=key]").closest(".form-group").hide(),a.html('<i class="fa fa-spinner fa-spin"></i> '+juzaweb.lang.installing),jwCMSUpdate("theme",1,null,{theme:n},(function(e){a.html(juzaweb.lang.activate),a.removeClass("install-theme"),a.addClass("active-theme"),a.data("theme",n),a.prop("disabled",!1)}),(function(e){show_message(e),a.prop("disabled",!1),a.html(o)})),!1)},failCallback:function(e){return show_message(e),a.html(o),a.prop("disabled",!1),!1}}),!1)})),e.on("submit","#form-login-juzaweb",(function(e){if(e.isDefaultPrevented())return!1;e.preventDefault();let t=$(this),a=t.find("button[type=submit]"),n=t.find("input[name=module]").val(),i=t.find("input[name=email]").val(),o=t.find("input[name=password]").val(),s=a.html();return!(!i||!o)&&(a.prop("disabled",!0),a.html('<i class="fa fa-spinner fa-spin"></i> '+juzaweb.lang.please_wait),ajaxRequest(juzaweb.adminUrl+"/module/login-juzaweb",{module:n,email:i,password:o},{method:"POST",callback:function(e){return!0!==e.status?(show_message(e),a.html(s),a.prop("disabled",!1),!1):(ajaxRequest(juzaweb.adminUrl+"/module/theme/buy-modal",{module:n},{method:"GET",callback:function(e){$("#show-modal .modal").modal("hide"),$("#show-modal").empty().html(e.data.html),$("#show-modal .modal").modal()},failCallback:function(e){show_message(e),a.html(s),a.prop("disabled",!1)}}),!1)},failCallback:function(e){return show_message(e),a.html(s),a.prop("disabled",!1),!1}}),!1)}))})),$(document).ready((function(){initSelect2("body")}));class JuzawebTable{constructor(e){this.url=e.url,this.action_url=e.action_url,this.remove_url=e.remove_url||null,this.status_url=e.status_url||null,this.remove_question=e.remove_question?e.remove_question:juzaweb.lang.remove_question.replace(":name",juzaweb.lang.the_selected_items),this.detete_button=e.detete_button?e.detete_button:"#delete-item",this.status_button=e.status_button?e.status_button:".status-button",this.apply_button=e.apply_button?e.apply_button:"#apply-action",this.table=e.table?e.table:".juzaweb-table",this.field_id=e.field_id?e.field_id:"id",this.form_search=e.form_search?e.form_search:"#form-search",this.sort_name=e.sort_name?e.sort_name:"id",this.sort_order=e.sort_order?e.sort_order:"desc",this.page_size=e.page_size?e.page_size:10,this.search=!!e.search&&e.search,this.method=e.method?e.method:"get",this.locale=e.locale?e.locale:"en-US",this.chunk_action=!!e.chunk_action&&e.chunk_action,this.inputRow="",this.init()}init(){let e=$(this.apply_button),t=$(this.status_button),a=$(".bulk-actions-button");e.prop("disabled",!0),t.prop("disabled",!0),a.prop("disabled",!0);let n=$(this.table),i=this.form_search,o=this.action_url,s=this.remove_question,l=this.url,d=this.field_id,r=this.method,c=this.locale,u=this.status_url,m=this.chunk_action;n.bootstrapTable({url:l,idField:d,method:r,locale:c,sidePagination:"server",pagination:!0,sortName:this.sort_name,sortOrder:this.sort_order,toggle:"table",search:this.search,pageSize:this.page_size,queryParams:function(e){let t=$(i).serializeArray();return $.each(t,(function(t,a){e[a.name]?e[a.name]+=","+a.value:e[a.name]=a.value})),e}}),$(this.form_search).on("change","select, input",(function(e){return e.isDefaultPrevented()||(e.preventDefault(),n.bootstrapTable("refresh")),!1})),$(this.form_search).on("submit",(function(e){return e.isDefaultPrevented()||(e.preventDefault(),n.bootstrapTable("refresh")),!1})),n.on("check.bs.table uncheck.bs.table check-all.bs.table uncheck-all.bs.table pre-body.bs.table",(()=>{!function(){let t=!n.bootstrapTable("getSelections").length;e.prop("disabled",t),a.prop("disabled",t)}()})),e.on("click",(function(){let e=$(this),t=e.closest("form"),a=e.html(),i=t.find("select[name=bulk_actions]").val(),l=t.find("input[name=_token]").val(),d=$("input[name=btSelectItem]:checked").map((function(){return $(this).val()})).get();if(!d||!i)return!1;if("delete"==i)confirm_message(s,(function(t){if(!t)return!1;e.html(juzaweb.lang.please_wait),e.prop("disabled",!0),ajaxRequest(o,{ids:d,action:i,_token:l},{callback:function(t){return e.prop("disabled",!1),e.html(a),!0===t.status?(show_message(t),t.data.window_redirect?(window.location=t.data.window_redirect,!1):t.data.redirect?(setTimeout((function(){window.location=t.data.redirect}),1e3),!1):(n.bootstrapTable("refresh"),$("select[name=bulk_actions]").val(null).trigger("change.select2"),!1)):(show_message(t),!1)}})}));else if(e.html(juzaweb.lang.please_wait),e.prop("disabled",!0),m){let t=$("input[name=btSelectItem]:checked");setTimeout((function(){let s;process_each(t,(function(){let e=$(this).val();return $(this).hide(),$(this).closest("label").find("span").html('<i class="fa fa-spinner fa-spin"></i>'),s=ajaxRequest(o,{ids:[e],action:i,_token:l},{async:!1,callback:function(e){return!1}}),s}),500,{completeCallback:function(t){return show_message(t),t.data.redirect?(setTimeout((function(){window.location=t.data.redirect}),1e3),!1):t.data.window_redirect?(setTimeout((function(){window.location=t.data.window_redirect}),1e3),!1):(e.prop("disabled",!1),e.html(a),n.bootstrapTable("refresh"),void $("select[name=bulk_actions]").val(null).trigger("change.select2"))}})}),500)}else ajaxRequest(o,{ids:d,action:i,_token:l},{callback:function(t){return!0===t.status?(show_message(t),t.data.window_redirect?(window.location=t.data.window_redirect,!1):t.data.redirect?(setTimeout((function(){window.location=t.data.redirect}),1e3),!1):t.data.window_redirect?(setTimeout((function(){window.location=t.data.window_redirect}),1e3),!1):(e.prop("disabled",!1),e.html(a),n.bootstrapTable("refresh"),$("select[name=bulk_actions]").val(null).trigger("change.select2"),!1)):(show_message(t),!1)}});return!1})),$(".bulk-actions-actions").on("click",".select-action",(function(){let e=a,t=e.html(),i=$(this).data("action"),l=$(this).closest("form").find("input[name=_token]").val(),d=$("input[name=btSelectItem]:checked").map((function(){return $(this).val()})).get();if(a.dropdown("toggle"),!d||!i)return!1;if("delete"==i)confirm_message(s,(function(a){if(!a)return!1;e.html(juzaweb.lang.please_wait),e.prop("disabled",!0),ajaxRequest(o,{ids:d,action:i,_token:l},{callback:function(a){return e.prop("disabled",!1),e.html(t),!0===a.status?(show_message(a),a.data.window_redirect?(window.location=a.data.window_redirect,!1):a.data.redirect?(setTimeout((function(){window.location=a.data.redirect}),1e3),!1):(n.bootstrapTable("refresh"),!1)):(show_message(a),!1)}})}));else if(e.html(juzaweb.lang.please_wait),e.prop("disabled",!0),m){let a=$("input[name=btSelectItem]:checked");setTimeout((function(){let s;process_each(a,(function(){let e=$(this).val();return $(this).hide(),$(this).closest("label").find("span").html('<i class="fa fa-spinner fa-spin"></i>'),s=ajaxRequest(o,{ids:[e],action:i,_token:l},{async:!1,callback:function(e){return!1}}),s}),500,{completeCallback:function(a){return show_message(a),a.data.redirect?(setTimeout((function(){window.location=a.data.redirect}),1e3),!1):a.data.window_redirect?(setTimeout((function(){window.location=a.data.window_redirect}),1e3),!1):(e.prop("disabled",!1),e.html(t),void n.bootstrapTable("refresh"))}})}),500)}else ajaxRequest(o,{ids:d,action:i,_token:l},{callback:function(a){return!0===a.status?(show_message(a),a.data.window_redirect?(window.location=a.data.window_redirect,!1):a.data.redirect?(setTimeout((function(){window.location=a.data.redirect}),1e3),!1):a.data.window_redirect?(setTimeout((function(){window.location=a.data.window_redirect}),1e3),!1):(e.prop("disabled",!1),e.html(t),n.bootstrapTable("refresh"),!1)):(show_message(a),!1)}});return!1})),t.on("click",(function(){let e=$("input[name=btSelectItem]:checked").map((function(){return $(this).val()})).get(),a=$(this).data("status");return e.length<=0||$.ajax({type:"POST",url:u,dataType:"json",data:{ids:e,status:a},success:function(e){return!0===e.status?(n.bootstrapTable("refresh"),t.prop("disabled",!0),$(".items-checked").prop("disabled",!0),!1):(show_message(e),!1)}}),!1})),n.on("click",".action-item",(function(){let e=[$(this).data("id")],t=$(this).data("action");return"delete"==t?Swal.fire({title:"",text:s,type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:juzaweb.lang.yes+"!",cancelButtonText:juzaweb.lang.cancel+"!"}).then((a=>{a.value&&($(this).html(juzaweb.lang.please_wait),$.ajax({type:"POST",url:o,dataType:"json",data:{ids:e,action:t},success:function(e){return e.data.window_redirect?(show_message(e),window.location=e.data.window_redirect,!1):e.data.redirect?(show_message(e),setTimeout((function(){window.location=e.data.redirect}),1e3),!1):void n.bootstrapTable("refresh")}}))})):($(this).html(juzaweb.lang.please_wait),$.ajax({type:"POST",url:o,dataType:"json",data:{ids:e,action:t},success:function(e){return e.data.window_redirect?(show_message(e),window.location=e.data.window_redirect,!1):e.data.redirect?(show_message(e),setTimeout((function(){window.location=e.data.redirect}),1e3),!1):void n.bootstrapTable("refresh")}})),!1}))}refresh(e={}){e?$(this.table).bootstrapTable("refreshOptions",e):$(this.table).bootstrapTable("refresh",e)}}class JuzawebListView{constructor(e){this.url=e.url,this.list=e.list?e.list:".juzaweb-list",this.method=e.method?e.method:"get",this.template=e.template?e.template:null,this.sort_name=e.sort_name?e.sort_name:"id",this.sort_order=e.sort_order?e.sort_order:"desc",this.page_size=e.page_size?e.page_size:10,this.after_load_callback=e.after_load_callback?e.after_load_callback:null,this.item_formatter=e.item_formatter?e.item_formatter:null,this.offset=0,this.total=0,this.page=1,this.init()}init(){let e=this;e.loadData(),$(window).scroll((function(){$(window).scrollTop()===$(document).height()-$(window).height()&&e.offset+e.page_size<e.total&&(e.page=e.page+1,e.loadData())}))}loadData(){let template=this.template?document.getElementById(this.template).innerHTML:null,result=$(this.list),itemFormatter=this.item_formatter;this.page>1&&(this.offset=this.page*this.page_size-this.page_size);let jqxhr=$.ajax({type:this.method,url:this.url,dataType:"json",cache:!1,async:!1,data:{page:this.page,limit:this.page_size}}),response=jqxhr.responseJSON;this.total=response.meta.total;let html="";response.data.length>0&&($.each(response.data,(function(index,item){itemFormatter?html=eval(itemFormatter)(index,item):html+=replace_template(template,item)})),result.append(html)),this.after_load_callback&&eval(this.after_load_callback)()}}function addStyleSubmenu(e){var t,a=e.find(".juzaweb__menuLeft__navigation"),n=(i=e.offset().top)-(t=$(window).scrollTop())-30,i=60+(e=i+a.height()+1)-$(".juzaweb__layout").height();(i=n<(i=(t=$(window).height()+t-50)<e-i?e-t:i)?n:i)>1&&i>40?a.css("margin-top","-"+i+"px"):a.css("margin-top","")}$(document).ready((function(){function sendMessageByResponse(e,t=!1){t?void 0!==show_notify&&"function"==typeof show_notify&&show_notify(e):void 0!==show_message&&"function"==typeof show_message&&show_message(e)}function sendRequestFormAjax(form,data,btnsubmit,currentText,currentIcon,captchaToken=null){let submitSuccess=form.data("success"),notify=form.data("notify")||!1;captchaToken&&data.append("g-recaptcha-response",captchaToken),$.ajax({type:form.attr("method"),url:form.attr("action"),dataType:"json",data:data,cache:!1,contentType:!1,processData:!1}).done((function(response){return sendMessageByResponse(response,notify),submitSuccess&&eval(submitSuccess)(form,response),response.data.redirect?(setTimeout((function(){window.location=response.data.redirect}),1e3),!1):(btnsubmit.find("i").attr("class",currentIcon),btnsubmit.prop("disabled",!1),btnsubmit.data("loading-text")&&btnsubmit.html(currentText),response.status,!1)})).fail((function(e){return btnsubmit.find("i").attr("class",currentIcon),btnsubmit.prop("disabled",!1),btnsubmit.data("loading-text")&&btnsubmit.html(currentText),sendMessageByResponse(e,notify),!1}))}function validate_isNumberKey(e){let t=e.which?e.which:event.keyCode;return 59==t||46==t||!(t>31&&(t<48||t>57))}function validate_FormatNumber(e){e.value=e.value.replace(/\,/gi,""),e.value=e.value.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}$(document).on("submit",".form-ajax",(function(e){if(e.isDefaultPrevented())return!1;e.preventDefault();let t=$(this),a=new FormData(t[0]),n=t.find("button[type=submit]"),i=n.html(),o=n.find("i").attr("class");if(n.find("i").attr("class","fa fa-spinner fa-spin"),n.prop("disabled",!0),n.data("loading-text")&&n.html('<i class="fa fa-spinner fa-spin"></i> '+n.data("loading-text")),"undefined"!=typeof grecaptcha)return loadRecapchaAndSubmit((function(e){sendRequestFormAjax(t,a,n,i,o,e)})),!1;sendRequestFormAjax(t,a,n,i,o)})),$(document).on("click",".load-modal",(function(e){if(e.isDefaultPrevented())return!1;e.preventDefault();let t=$(this).data(),a=$(this),n=a.find("i").attr("class");a.find("i").attr("class","fa fa-spinner fa-spin"),a.prop("disabled",!0),a.addClass("disabled");let i="";$.each(t,(function(e,t){"url"!==e&&(i+="&"+e+"="+t)}));let o=$(this).data("url");i&&(o=o+"?"+i),$.ajax({type:"GET",url:o,dataType:"json",data:{},cache:!1,contentType:!1,processData:!1}).done((function(e){return a.find("i").attr("class",n),a.prop("disabled",!1),a.removeClass("disabled"),!1===e.status||($("#show-modal").html(e.data.source),$("#show-modal .modal").modal()),!1})).fail((function(e){return a.find("i").attr("class",n),a.prop("disabled",!1),!1}))})),$(document).on("keypress",".is-number",(function(){return validate_isNumberKey(this)})),$(document).on("keyup",".number-format",(function(){return validate_FormatNumber(this)}))})),$(document).ready((function(){$(".form-taxonomy").on("click",".add-new",(function(){let e=$(this).closest(".form-taxonomy").find(".form-add");e.is(":visible")?e.hide("slow"):e.show("slow")})),$("body").on("change",".select-tags",(function(){let e=$(this),t=e.val(),a=e.data("taxonomy"),n=e.data("type");$.ajax({type:"GET",url:juzaweb.adminUrl+"/taxonomy/"+n+"/"+a+"/component-item",dataType:"json",data:{id:t}}).done((function(t){return!1===t.status?(show_message(t),!1):(e.closest(".form-taxonomy").find(".show-tags").append(t.data.html),e.val(null).trigger("change.select2"),!1)})).fail((function(e){return show_message(e),!1}))})),$(document).on("click",".remove-tag-item",(function(){$(this).closest(".tag").remove()})),$(document).on("click",".form-add-taxonomy button",(function(){let e=$(this),t=e.closest(".form-add"),a=t.find(".taxonomy-name").val(),n=t.find(".taxonomy-parent").val(),i=e.data("type"),o=e.data("taxonomy"),s=e.data("post_type"),l=e.find("i").attr("class");e.find("i").attr("class","fa fa-spinner fa-spin"),e.prop("disabled",!0),$.ajax({type:"POST",url:juzaweb.adminUrl+"/taxonomy/"+i+"/"+o,dataType:"json",data:{name:a,parent_id:n,post_type:s,taxonomy:o}}).done((function(a){if(e.find("i").attr("class",l),e.prop("disabled",!1),!1===a.status)return show_message(a),!1;let i=e.closest(".form-taxonomy").find(".show-tags");if(i.length)i.append(a.data.html);else{let t=a.data.item,o=`<li class="m-1" id="item-category-${t.id}">\n                    <div class="custom-control custom-checkbox">\n                        <input type="checkbox" name="${t.taxonomy}[]" class="custom-control-input" id="${t.taxonomy}-${t.id}" value="${t.id}" checked>\n                        <label class="custom-control-label" for="${t.taxonomy}-${t.id}">${t.name}</label>\n                    </div>\n                </li>`;n?(i=e.closest(".form-taxonomy").find(".show-taxonomies ul #item-category-"+t.parent_id+" ul:first"),i.length?i.append(o):(o='<ul class="mt-2 p-0">'+o+"</ul>",e.closest(".form-taxonomy").find(".show-taxonomies ul #item-category-"+t.parent_id).append(o))):e.closest(".form-taxonomy").find(".show-taxonomies ul:first").append(o)}return t.find(".taxonomy-name").val(""),n&&t.find(".taxonomy-parent").val(null).trigger("change.select2"),!1})).fail((function(t){return e.find("i").attr("class",l),e.prop("disabled",!1),show_message(t),!1}))}))})),$(document).ready((function(){let e=$("body");e.on("change",".show_on_front-change",(function(){let e=$(this).val();"posts"==e&&$(".select-show_on_front").prop("disabled",!0),"page"==e&&$(".select-show_on_front").prop("disabled",!1)})),e.on("click",".cancel-button",(function(){window.location=""})),e.on("change",".generate-slug",(function(){let e=$(this).val();ajaxRequest(juzaweb.adminUrl+"/load-data/generateSlug",{title:e},{method:"GET",callback:function(e){$("input[name=slug]").val(e.slug).trigger("change")}})})),e.on("click",".slug-edit",(function(){let e=$(this).closest(".input-group").find("input:first");e.prop("readonly",!e.prop("readonly"))})),e.on("click",".close-message",(function(){let e=$(this).data("id");ajaxRequest(juzaweb.adminUrl+"/remove-message",{id:e},{method:"POST",callback:function(e){}})})),$(".juzaweb__menuLeft__submenu").on("mouseover",(function(){$(this).hasClass("juzaweb__menuLeft__submenu--toggled")||addStyleSubmenu($(this))}))})),$(document).ready((function(){})),$(document).ready((function(){let e=new URLSearchParams(window.location.search).get("template"),t=$("body");e&&$('select[name="meta[template]"]').val(e).trigger("change"),t.on("click",".show-form-block",(function(){let e=$(this).closest(".dd-item").find(".form-block-edit");e.is(":hidden")?e.show("slow"):e.hide("slow")})),t.on("click",".remove-form-block",(function(){$(this).closest(".dd-item").remove()})),t.on("change",'select[name="meta[template]"]',(function(){let e=$(this).val();if(!e)return!1;let t=window.location.href;t=t.split("?")[0],window.location=t+"?template="+e})),t.on("click",".add-block-data",(function(){let e=$(this).data("block"),t=$(this).data("content_key"),a=$(this),n=document.getElementById("block-"+e+"-template").innerHTML,i=(new Date).getTime();n=replace_template(n,{marker:i,content_key:t}),a.closest(".page-block-content").find(".dd-empty").remove(),a.closest(".page-block-content").find(".dd-list").append(n),initSelect2("#page-block-"+i)}))}));
